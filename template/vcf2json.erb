=HEADER
<% require 'json' 
   @info = []
%>
{
    "HEADER": {
	"options": <%= options.to_h.to_json %>,
	"files": <%= ARGV %>,
	"version": "<%= BIOVCF_VERSION %>"
    },
    "BODY": [
=BODY
	<% 	
		chr = rec.chrom
		pos = rec.pos
		ref = rec.ref
		alt = rec.alt[0]
		dp = rec.info.dp
		
		@info << [chr,pos,ref,alt,dp]	
	%>
=FOOTER
	<% 
	   l = @info.length
	   @i = 1
	   @info.each do |array|
		if( @i < l)
		%> 
		   {
			"seq:chr": "<%= array[0]%>",
			"seq:pos": <%= array[1] %>,
			"seq:ref": "<%= array[2] %>",
			"seq:alt": "<%= array[3] %>",
			"dp":      <%= array[4] %>
		   },<%
		else
		%>
		   {
			"seq:chr": "<%= array[0]%>",
			"seq:pos": <%= array[1] %>,
			"seq:ref": "<%= array[2] %>",
			"seq:alt": "<%= array[3] %>",
			"dp":      <%= array[4] %>
		   }
		   <%
		end
		@i = @i + 1 
	   end%>
    ]
}
